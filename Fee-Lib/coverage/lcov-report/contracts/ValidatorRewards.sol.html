<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts/ValidatorRewards.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">contracts/</a> ValidatorRewards.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>44/44</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>30/30</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>16/16</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>63/63</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1041×</span>
<span class="cline-any cline-yes">1041×</span>
<span class="cline-any cline-yes">1041×</span>
<span class="cline-any cline-yes">1041×</span>
<span class="cline-any cline-yes">1041×</span>
<span class="cline-any cline-yes">1647×</span>
<span class="cline-any cline-yes">1647×</span>
<span class="cline-any cline-yes">1647×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">33×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-yes">14×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// SPDX-License-Identifier: MIT
&nbsp;
pragma solidity ^0.8.0;
&nbsp;
import "@openzeppelin/contracts/utils/Address.sol";
import "@openzeppelin/contracts/utils/Context.sol";
import "@openzeppelin/contracts-upgradeable/access/AccessControlUpgradeable.sol";
import "@openzeppelin/contracts-upgradeable/proxy/utils/Initializable.sol";
import "@openzeppelin/contracts-upgradeable/proxy/utils/UUPSUpgradeable.sol";
&nbsp;
import "./Errors.sol";
&nbsp;
/** 
@title ValidatorRewards
@notice This contract ensures fees are sent to the validator addresses.
@dev The primary function of this contract is to disburse funds from Haven applications.
*/
&nbsp;
contract ValidatorRewards is
    Initializable,
    AccessControlUpgradeable,
    UUPSUpgradeable
{
    /**
     * @dev Event for when a new Validator is added. Includes their address and total shares.
     */
    event ValidatorAdded(address account, uint256 shares);
&nbsp;
    /**
     * @dev Event for when shares are adjusted.
     */
    event SharesAdjusted(address validator, uint256 shares);
&nbsp;
    /**
     * @dev Event for when a validator is removed.
     */
    event ValidatorRemoved(
        address account,
        uint256 shares,
        uint256 newTotalSharesAmount
    );
&nbsp;
    /**
     * @dev Event for when the validator address is changed. Used in `adjustValidatorAddress`.
     */
    event UpdatedValidator(
        address indexed previousValidatorRewardAddress,
        address indexed newValidatorRewardAddress
    );
&nbsp;
    /**
     * @dev Event for when a validator receives a payment.
     */
    event PaymentReleased(address indexed to, uint256 indexed amount);
&nbsp;
    // Sum of all shares collectively held by addresses for division of H1.
    uint256 private _totalShares;
&nbsp;
    // Sum of all H1 collectively dispersed.
    uint256 private _totalH1IssuedToValidators;
&nbsp;
    // Mapping between an address and the number of shares of H1 it receives.
    // Payment = _shares/_totalShares * contract balance.
    mapping(address =&gt; uint256) private _shares;
&nbsp;
    // Mapping between an address and how much H1 it has received.
    mapping(address =&gt; uint256) private _dispersed;
&nbsp;
    // Array of all the addresses that receive H1.
    address[] private validatorsAddressArray;
&nbsp;
    // Role to control contract distribution.
    bytes32 public constant OPERATOR_ROLE = keccak256("OPERATOR_ROLE");
&nbsp;
    /**
   @notice `initialize` occurs when the contract deploys with a list of validator addresses and their total shares.
   @param validatorsList an array of validators to accept fees.
   @param shares is an array of shares that is part of the total amount distributed from the contract.
   @param havenFoundation is the address that can grant and remove permissions aka the DEFAULT_ADMIN_ROLE.
   @param networkOperator the address that calls restricted functions in the contract aka OPERATOR_ROLE.
   @dev The shares for each address are the amount over the total amount for all addresses.
   */
    function initialize(
        address[] memory validatorsList,
        uint256[] memory shares,
        address havenFoundation,
        address networkOperator
    ) external initializer {
        _grantRole(DEFAULT_ADMIN_ROLE, havenFoundation);
        _grantRole(OPERATOR_ROLE, networkOperator);
        __AccessControl_init();
        __UUPSUpgradeable_init();
        for (uint256 i = 0; i &lt; validatorsList.length; i++) {
            validatorsAddressArray.push(validatorsList[i]);
            _shares[validatorsList[i]] = shares[i];
            _totalShares = _totalShares + shares[i];
        }
    }
&nbsp;
    /**
     * @notice Function to receive tokens.
     */
    receive() external payable {}
&nbsp;
    /**
   @notice `adjustValidatorShares` adjusts the total number of shares received by an address.
   @param account the address that the share number should be adjusted for.
   @param shares the new share number for the account.
   */
&nbsp;
    function adjustValidatorShares(
        address account,
        uint256 shares
    ) external onlyRole(OPERATOR_ROLE) {
        require(
            isTheAddressInTheValidatorsArray(account) == false,
            Errors.NO_DUPLICATES
        );
        require(shares &gt; 0, Errors.ZERO_VARIABLE_NOT_ACCEPTED);
        _totalShares -= _shares[account];
        _totalShares += shares;
        _shares[account] = shares;
        emit SharesAdjusted(account, shares);
    }
&nbsp;
    /**
   @notice `adjustValidatorAddress` trades out one validator for another.
   @param index the index in the validator address in the array.
   @param newValidatorRewardAddress The number of shares owned by the payee.
   */
&nbsp;
    function adjustValidatorAddress(
        uint256 index,
        address newValidatorRewardAddress
    ) external onlyRole(OPERATOR_ROLE) {
        require(
            newValidatorRewardAddress != address(0),
            Errors.INVALID_ADDRESS
        );
        address previousAddress = validatorsAddressArray[index];
        uint256 sharesAdjusted = _shares[previousAddress];
        _shares[previousAddress] = 0;
        _shares[newValidatorRewardAddress] = sharesAdjusted;
        validatorsAddressArray[index] = newValidatorRewardAddress;
        emit UpdatedValidator(previousAddress, newValidatorRewardAddress);
    }
&nbsp;
    /**
   @notice `addValidator` adds a new validator to the contract.
   @param account The address of the payee to add.
   @param shares The number of shares owned by the payee.
   */
    function addValidator(
        address account,
        uint256 shares
    ) external onlyRole(OPERATOR_ROLE) {
        require(account != address(0), Errors.ZERO_ADDRESS_NOT_VALID_ARGUMENT);
        require(shares &gt; 0, Errors.ZERO_VARIABLE_NOT_ACCEPTED);
        require(_shares[account] == 0, Errors.ADDRESS_ALREADY_HAS_A_VALUE);
&nbsp;
        validatorsAddressArray.push(account);
        _shares[account] = shares;
        _totalShares = _totalShares + shares;
        emit ValidatorAdded(account, shares);
    }
&nbsp;
    /**
   @notice `removeValidator` removes existing validator information from the contract.
   @param account The address of the validator to remove.
   @param index is the index that the validator is in the validatorsAddressArray.
   */
    function removeValidator(
        address account,
        uint256 index
    ) external onlyRole(OPERATOR_ROLE) {
        require(_shares[account] &gt; 0, Errors.INVALID_ADDRESS);
        for (uint i = index; i &lt; validatorsAddressArray.length - 1; i++) {
            validatorsAddressArray[i] = validatorsAddressArray[i + 1];
        }
        validatorsAddressArray.pop();
        uint256 shares = _shares[account];
        _totalShares -= shares;
        _shares[account] = 0;
        emit ValidatorRemoved(account, shares, _totalShares);
    }
&nbsp;
    /**
   @notice `totalShares` is the getter for the total shares held by validators.
   */
    function totalShares() public view returns (uint256) {
        return _totalShares;
    }
&nbsp;
    /**
   @notice `totalH1Issued` is the getter for the total amount of Wrapped H1 already dispersed.
   */
    function totalH1Issued() public view returns (uint256) {
        return _totalH1IssuedToValidators;
    }
&nbsp;
    /**
   @notice `shares` is the getter for the amount of shares held by an account.
   @param account the account to check the share amount.
   */
    function shares(address account) public view returns (uint256) {
        return _shares[account];
    }
&nbsp;
    /**
   @notice `dispersed` is the getter for the amount of Wrapped H1 already dispersed to a payee.
   @param account is the account to check the share amount.
   */
    function dispersed(address account) public view returns (uint256) {
        return _dispersed[account];
    }
&nbsp;
    /**
   @notice `validators` is the getter for the address of the validator number position of the array of validators.
   @param index the index in the array.
   */
    function validators(uint256 index) public view returns (address) {
        return validatorsAddressArray[index];
    }
&nbsp;
    /**
   @notice `releasable` is the getter for the amount of validator's Wrapped H1 in contract.
   @param account the account to check the amount of total received and dispersed amount.
   */
    function releasable(address account) public view returns (uint256) {
        uint256 totalReceived = address(this).balance + totalH1Issued();
        return _pendingPayment(account, totalReceived, dispersed(account));
    }
&nbsp;
    /**
     * @notice `disperseSinglePaymentToValidator` triggers a transfer to a single `account` of the amount of Wrapped H1 they are owed,
     * according to their percentage of the total shares and their previous withdrawals.
     * @param account the account to check the amount of total received and dispersed amount.
     */
&nbsp;
    function disperseSinglePaymentToValidator(address payable account) public {
        require(_shares[account] &gt; 0, Errors.ACCOUNT_HAS_NO_SHARES);
        uint256 payment = releasable(account);
&nbsp;
        _totalH1IssuedToValidators += payment;
        unchecked {
            _dispersed[account] += payment;
        }
&nbsp;
        Address.sendValue(account, payment);
        emit PaymentReleased(account, payment);
    }
&nbsp;
    /**
     * @notice `disperseAllPaymentsToValidators` triggers a transfer to all validators of the amount of
     * Wrapped H1 they are owed, according to their percentage of the total shares and their previous withdrawals.
     */
&nbsp;
    function disperseAllPaymentsToValidators() external {
        for (uint i; i &lt; validatorsAddressArray.length; i++) {
            uint256 payment = releasable(validatorsAddressArray[i]);
            _totalH1IssuedToValidators += payment;
            unchecked {
                _dispersed[validatorsAddressArray[i]] += payment;
            }
            address payable account = payable(
                address(validatorsAddressArray[i])
            );
            Address.sendValue(account, payment);
            emit PaymentReleased(validatorsAddressArray[i], payment);
        }
    }
&nbsp;
    /**
   @notice `isTheAddressInTheValidatorsArray` This view function checks if the address is in the validatorList array.
   @param validator the address for in the validatorsList.
   @dev It is used in functions above to ensure no duplicate addresses are added to the validatorList.
   */
&nbsp;
    function isTheAddressInTheValidatorsArray(
        address validator
    ) public view returns (bool) {
        for (uint i = 0; i &lt; validatorsAddressArray.length; i++) {
            if (validatorsAddressArray[i] == validator) {
                return false;
            }
        }
        return true;
    }
&nbsp;
    /**
   @notice `_authorizeUpgrade` function to upgrade contract override to protect.
   @param newImplementation new implementation address.
   */
&nbsp;
    function _authorizeUpgrade(
        address newImplementation
    ) internal override onlyRole(DEFAULT_ADMIN_ROLE) {}
&nbsp;
    /**
     * @notice `_pendingPayment` internal logic for computing the pending payment of an `account`
     * given the token historical balances and already dispersed amounts.
     * @param account the account to check the amount of total received and dispersed amount.
     * @param totalReceived the account to check the amount of total received and dispersed amount.
     * @param alreadyReleased the account to check the amount of total received and dispersed amount.
     */
&nbsp;
    function _pendingPayment(
        address account,
        uint256 totalReceived,
        uint256 alreadyReleased
    ) private view returns (uint256) {
        return
            (totalReceived * _shares[account]) / _totalShares - alreadyReleased;
    }
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Mon Jul 10 2023 09:15:20 GMT-0400 (Eastern Daylight Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
